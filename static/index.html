<!doctype html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>News Automation</title>
<style>
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,Helvetica,Ubuntu;background:#0b0f14;color:#e8eef6}
  .wrap{max-width:980px;margin:30px auto;padding:0 16px}
  h1{font-size:22px;margin:0 0 10px}
  .card{background:#121a22;border:1px solid #1f2a36;border-radius:10px;padding:16px;margin:12px 0}
  input,select,button{padding:10px;border-radius:8px;border:1px solid #2a3b4d;background:#0e141b;color:#e8eef6}
  button{background:#16a34a;border:0;cursor:pointer}
  .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
  .mt{margin-top:8px}
  a{color:#8ecaff}
  table{width:100%;border-collapse:collapse;margin-top:10px}
  td,th{border-bottom:1px solid #233243;padding:8px;font-size:14px}
  .small{opacity:.8;font-size:12px}
</style>
<div class="wrap">
  <h1>ðŸ“° News Automation</h1>
  <div class="card">
    <div class="row">
      <input id="kw" placeholder="Palavra-chave" value="Litoral Norte de SÃ£o Paulo" style="flex:1">
      <select id="hours">
        <option value="5">Ãšltimas 5h</option>
        <option value="8">Ãšltimas 8h</option>
        <option value="12" selected>Ãšltimas 12h</option>
        <option value="24">Ãšltimas 24h</option>
      </select>
      <label><input type="checkbox" id="h1" checked> Exigir H1/tÃ­tulo</label>
      <label><input type="checkbox" id="img" checked> Exigir imagem</label>
      <button id="go">Coletar agora</button>
    </div>
    <div class="row mt small">
      Links: <a id="rss" href="#" target="_blank">RSS</a> â€” <a id="json" href="#" target="_blank">JSON</a>
    </div>
    <div id="out" class="mt small">OK. Use tambÃ©m /crawl_site para pÃ¡ginas de listagem.</div>
  </div>
</div>
<script>
const base = location.origin;
const $ = sel => document.querySelector(sel);
function updateLinks(){
  const slug = ($('#kw').value||'').toLowerCase().trim().replace(/\s+/g,'-').replace(/[^a-z0-9\-]/g,'');
  const h = $('#hours').value||12;
  $('#rss').href = `${base}/rss/${slug}?hours=${h}`;
  $('#json').href = `${base}/api/json/${slug}?hours=${h}`;
}
updateLinks();
['kw','hours'].forEach(id => $('#'+id).addEventListener('input', updateLinks));
$('#go').onclick = async () => {
  $('#out').textContent = 'Coletando...';
  const kw = $('#kw').value.trim(); const h1 = $('#h1').checked; const img = $('#img').checked;
  const body = {keywords:[kw], hours_max:12, require_h1:h1, require_image:img};
  const r = await fetch('/crawl', {method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(body)});
  const js = await r.json().catch(()=>({}));
  $('#out').textContent = JSON.stringify(js, null, 2);
};
</script>
